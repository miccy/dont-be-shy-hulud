{
  "meta": {
    "description": "Indicators of Compromise (IOCs) for Shai-Hulud 2.0 npm worm",
    "last_updated": "2025-11-28",
    "update_frequency": "Daily during active incidents",
    "sources": [
      "https://github.com/DataDog/indicators-of-compromise/tree/main/shai-hulud-2.0",
      "https://github.com/wiz-sec-public/wiz-research-iocs",
      "https://github.com/tenable/shai-hulud-second-coming-affected-packages",
      "https://github.com/safedep/shai-hulud-migration-response"
    ],
    "note": "This list is regularly updated from vendor sources. Always cross-reference with official vendor IOC lists for the most current data."
  },
  "high_risk_packages": {
    "description": "Packages with highest deployment rates that were compromised",
    "packages": [
      {
        "name": "@postman/tunnel-agent",
        "risk_level": "critical",
        "deployment_rate": "27%",
        "affected_versions": ["Check vendor sources"],
        "notes": "High prevalence in cloud environments"
      },
      {
        "name": "posthog-node",
        "risk_level": "critical",
        "deployment_rate": "25%",
        "affected_versions": ["Check vendor sources"],
        "notes": "Analytics package, widely deployed"
      },
      {
        "name": "posthog-js",
        "risk_level": "critical",
        "deployment_rate": "15%",
        "affected_versions": ["Check vendor sources"],
        "notes": "Client-side analytics"
      },
      {
        "name": "@asyncapi/specs",
        "risk_level": "critical",
        "deployment_rate": "20%",
        "affected_versions": ["Check vendor sources"],
        "notes": "AsyncAPI tooling"
      },
      {
        "name": "@asyncapi/openapi-schema-parser",
        "risk_level": "critical",
        "deployment_rate": "17%",
        "affected_versions": ["Check vendor sources"],
        "notes": "Schema parser"
      },
      {
        "name": "angulartics2",
        "risk_level": "high",
        "deployment_rate": "Unknown",
        "affected_versions": ["Check vendor sources"],
        "notes": "Angular analytics"
      },
      {
        "name": "koa2-swagger-ui",
        "risk_level": "high",
        "deployment_rate": "Unknown",
        "affected_versions": ["Check vendor sources"],
        "notes": "Swagger UI for Koa"
      },
      {
        "name": "tinycolor",
        "risk_level": "high",
        "deployment_rate": "Unknown",
        "affected_versions": ["v4.1.2"],
        "notes": "Color manipulation library - specific version affected"
      }
    ]
  },
  "ioc_files": {
    "description": "File indicators of compromise",
    "files": [
      {
        "filename": "setup_bun.js",
        "type": "dropper",
        "description": "Initial loader script, typically in preinstall hook",
        "detection": "find . -name 'setup_bun.js' 2>/dev/null"
      },
      {
        "filename": "bun_environment.js",
        "type": "payload",
        "description": "Main malicious payload (~10MB, heavily obfuscated)",
        "detection": "find . -name 'bun_environment.js' 2>/dev/null"
      },
      {
        "filename": "actionsSecrets.json",
        "type": "exfiltration",
        "description": "Stolen GitHub Actions secrets (double base64 encoded)",
        "detection": "find . -name 'actionsSecrets.json' 2>/dev/null"
      },
      {
        "filename": "cloud.json",
        "type": "exfiltration",
        "description": "Cloud credentials (AWS, GCP, Azure)",
        "detection": "find . -name 'cloud.json' 2>/dev/null"
      },
      {
        "filename": "contents.json",
        "type": "exfiltration",
        "description": "Repository contents",
        "detection": "find . -name 'contents.json' 2>/dev/null"
      },
      {
        "filename": "environment.json",
        "type": "exfiltration",
        "description": "Environment variables",
        "detection": "find . -name 'environment.json' 2>/dev/null"
      },
      {
        "filename": "truffleSecrets.json",
        "type": "exfiltration",
        "description": "Secrets found by TruffleHog scan",
        "detection": "find . -name 'truffleSecrets.json' 2>/dev/null"
      }
    ]
  },
  "behavioral_iocs": {
    "description": "Behavioral indicators of compromise",
    "indicators": [
      {
        "type": "github_repo",
        "pattern": "Repository description contains 'Sha1-Hulud: The Second Coming'",
        "detection": "gh repo list --json description | jq -r '.[] | select(.description | contains(\"Hulud\"))'"
      },
      {
        "type": "github_actions",
        "pattern": "Self-hosted runner named 'SHA1HULUD'",
        "detection": "Check Actions runners in GitHub settings"
      },
      {
        "type": "workflow_file",
        "pattern": "Workflow files matching 'formatter_*.yml' in .github/workflows/",
        "detection": "find .github/workflows -name 'formatter_*.yml'"
      },
      {
        "type": "directory",
        "pattern": ".truffler-cache directory in home folder",
        "detection": "ls -la ~/.truffler-cache"
      },
      {
        "type": "process",
        "pattern": "Unexpected Bun processes",
        "detection": "ps aux | grep bun | grep -v grep"
      },
      {
        "type": "package_json",
        "pattern": "preinstall script with 'setup_bun' or 'bun_environment'",
        "detection": "grep -r '\"preinstall\".*setup_bun\\|bun_environment' package.json"
      }
    ]
  },
  "network_iocs": {
    "description": "Network indicators (if any identified)",
    "note": "Shai-Hulud 2.0 primarily uses GitHub for exfiltration, not external C&C servers",
    "indicators": []
  },
  "file_hashes": {
    "description": "SHA-256 hashes of known malicious files",
    "note": "Payloads are polymorphic - hashes change frequently. Use behavioral detection instead.",
    "hashes": []
  }
}
